# Highway-Env å¤šåœºæ™¯PPOè®­ç»ƒæ¡†æ¶ - ç»¼åˆæŒ‡å—

> åŸºäºStable Baselines3çš„å¼ºåŒ–å­¦ä¹ æ¡†æ¶ï¼Œæ”¯æŒé«˜é€Ÿé©¾é©¶ã€ç¯å²›é€šè¿‡å’Œå€’è½¦å…¥åº“ä¸‰å¤§åœºæ™¯çš„ç‹¬ç«‹è®­ç»ƒä¸è¯„ä¼°

**ç‰ˆæœ¬**: v2.1 Advanced Training Enhancements  
**æœ€åæ›´æ–°**: 2026-01-19  
**çŠ¶æ€**: âœ… å°±ç»ªå¯éƒ¨ç½²

---

## ğŸ“‘ ç›®å½•

- [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [3å¤§æ ¸å¿ƒæ”¹è¿›](#3å¤§æ ¸å¿ƒæ”¹è¿›)
- [åœºæ™¯è¯¦è§£](#åœºæ™¯è¯¦è§£)
- [å®Œæ•´å‚æ•°æŒ‡å—](#å®Œæ•´å‚æ•°æŒ‡å—)
- [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)
- [é…ç½®æ¨èé€ŸæŸ¥è¡¨](#é…ç½®æ¨èé€ŸæŸ¥è¡¨)

---

## æ ¸å¿ƒç‰¹æ€§

âœ… **å¤šåœºæ™¯ç‹¬ç«‹ç®¡ç†** - ä¸åŒåœºæ™¯çš„è®­ç»ƒç»“æœå®Œå…¨éš”ç¦»  
âœ… **è‡ªåŠ¨ç‰ˆæœ¬ç¼–å·** - æ¯æ¬¡è®­ç»ƒè‡ªåŠ¨ç”Ÿæˆé€’å¢çš„run_Nç¼–å·  
âœ… **çµæ´»çš„æ¨¡å‹åŠ è½½** - æ”¯æŒåŠ è½½æŒ‡å®šç¼–å·æˆ–æœ€æ–°çš„æ¨¡å‹  
âœ… **è¯¦ç»†çš„è¯„ä»·æŒ‡æ ‡** - æ¯ä¸ªåœºæ™¯æœ‰é’ˆå¯¹æ€§çš„è¯„ä»·æ ‡å‡†  
âœ… **è§†é¢‘å½•åˆ¶** - è‡ªåŠ¨ä¿å­˜æµ‹è¯•è¿‡ç¨‹çš„è§†é¢‘  
âœ… **TensorBoardæ”¯æŒ** - å®æ—¶ç›‘æ§è®­ç»ƒè¿›åº¦  
âœ… **å¹³ç¨³é©¾é©¶ä¼˜åŒ–** - v2.1æ–°å¢çš„æ·±åº¦ä¼˜åŒ–ç®—æ³•  
âœ… **åˆ†åœºæ™¯è¶…å‚æ•°** - æ ¹æ®ä»»åŠ¡å¤æ‚åº¦æ™ºèƒ½è°ƒæ•´

---

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒä¾èµ–

```bash
pip install gymnasium stable-baselines3 highway-env tensorboard torch
```

### æ–‡ä»¶ç»“æ„

```
MY_TEST/
â”œâ”€â”€ train_highway_ppo.py          # å¤šåœºæ™¯è®­ç»ƒè„šæœ¬
â”œâ”€â”€ test_highway_ppo.py           # å¤šåœºæ™¯æµ‹è¯•è„šæœ¬
â”œâ”€â”€ highway_ppo/                  # è®­ç»ƒç»“æœå­˜å‚¨ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â”‚   â”œâ”€â”€ highway_merge/            # é«˜é€Ÿå…¬è·¯+æ±‡å…¥åœºæ™¯
â”‚   â”œâ”€â”€ roundabout/               # ç¯å²›åœºæ™¯
â”‚   â””â”€â”€ parking/                  # åœè½¦åœºæ™¯
â”œâ”€â”€ video/                        # æµ‹è¯•æ—¶å½•åˆ¶çš„è§†é¢‘ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â””â”€â”€ README.md                     # æœ¬æ–‡ä»¶
```

### ä¸€é”®è®­ç»ƒ

```bash
cd MY_TEST

# 1. è®­ç»ƒé«˜é€Ÿé©¾é©¶ (æ¨èé¦–é€‰ï¼Œ3-4å°æ—¶)
python train_highway_ppo.py --scenario 1

# 2. è®­ç»ƒå€’è½¦å…¥åº“ (æœ€å¤æ‚ï¼Œ5-6å°æ—¶)
python train_highway_ppo.py --scenario 3

# 3. è®­ç»ƒç¯å²›é€šè¿‡ (2.5-3.5å°æ—¶)
python train_highway_ppo.py --scenario 2
```

### ä¸€é”®æµ‹è¯•

```bash
# æµ‹è¯•é«˜é€Ÿé©¾é©¶ï¼ˆè‡ªåŠ¨åŠ è½½æœ€æ–°æ¨¡å‹ï¼‰
python test_highway_ppo.py --scenario 1

# æµ‹è¯•åœè½¦åœºæ™¯çš„ç¬¬1ä¸ªè®­ç»ƒç»“æœ
python test_highway_ppo.py --scenario 3 --run_id 1

# æµ‹è¯•ç¯å²›ï¼ˆè‡ªåŠ¨åŠ è½½æœ€æ–°ï¼‰
python test_highway_ppo.py --scenario 2
```

---

## 3å¤§æ ¸å¿ƒæ”¹è¿› (v2.1)

é’ˆå¯¹"é«˜é€Ÿé©¾é©¶ä¸ç¨³å®š"å’Œ"å€’è½¦å…¥åº“ç²¾åº¦ä¸è¶³"çš„é—®é¢˜ï¼Œå®æ–½äº†ä¸‰å¤§æ”¹è¿›ã€‚

### ğŸ¯ æ”¹è¿›1ï¼šé«˜é€Ÿé©¾é©¶ç¨³å®šæ€§ä¼˜åŒ–

**é—®é¢˜**: æ€¥åŠ é€Ÿã€æ€¥å‡é€Ÿã€é¢‘ç¹æ¢é“ï¼Œé©¾é©¶ä¸å¹³ç¨³

**æ ¹æœ¬åŸå› **:
- ç¼ºä¹é€Ÿåº¦åˆ†é˜¶æ®µç­–ç•¥ (20m/så’Œ28m/sç”¨åŒæ ·å¥–åŠ±)
- åŠ é€Ÿå¥–åŠ±è¿‡é«˜ (+0.5) å¯¼è‡´è¿‡åº¦åŠ é€Ÿ
- ç¼ºä¹é€Ÿåº¦æ³¢åŠ¨ç›‘æ§
- Episodeå¤ªçŸ­ (40s)
- ç½‘ç»œå¤ªå° [256,256]

**è§£å†³æ–¹æ¡ˆ**:

```python
# âœ… é€Ÿåº¦åˆ†é˜¶æ®µå¥–åŠ±
é«˜é€Ÿæ¨¡å¼ (> 25 m/s):
  â”œâ”€ IDLEç»´æŒé€Ÿåº¦       (+0.4)  â† æœ€é¼“åŠ±
  â”œâ”€ SLOWERå¹³ç¨³å‡é€Ÿ     (+0.15)
  â”œâ”€ FASTERå°å¹…åŠ é€Ÿ     (+0.05)
  â””â”€ ç»§ç»­åŠ é€Ÿ (>28m/s)  (-0.3)  â† å¼ºçƒˆæƒ©ç½š

# âœ… é€Ÿåº¦æ–¹å·®ç›‘æ§
ç›‘æ§æœ€è¿‘5æ­¥é€Ÿåº¦æ³¢åŠ¨ï¼Œæ³¢åŠ¨å¤§æ—¶æƒ©ç½š
reward -= variance * 0.05

# âœ… é…ç½®å¢å¼º
- Episodeæ—¶é—´: 40s â†’ 60s (æ›´é•¿çš„å­¦ä¹ )
- ç½‘ç»œå¤§å°: [256,256] â†’ [384,256] (æ›´å¼ºçš„è¡¨è¾¾åŠ›)
- è®­ç»ƒæ­¥æ•°: 100K â†’ 300K (3å€è®­ç»ƒ)
```

**é¢„æœŸæ•ˆæœ**:
- åŠ é€Ÿ/å‡é€Ÿé¢‘ç‡ â†“ 30-40%
- é€Ÿåº¦æ³¢åŠ¨ â†“ 40-50%
- ç¢°æ’ç‡ â†“ 50-75%
- æˆåŠŸç‡ â†‘ 85-95%

---

### ğŸ¯ æ”¹è¿›2ï¼šå€’è½¦å…¥åº“ç²¾åº¦ä¼˜åŒ–

**é—®é¢˜**: åœä¸å‡†ã€ç¢°æ’å¤šã€å€’è½¦ä¸å¹³ç¨³

**æ ¹æœ¬åŸå› **:
- é€šç”¨å¥–åŠ±å‡½æ•°ï¼Œæ²¡æœ‰é’ˆå¯¹è¿ç»­åŠ¨ä½œä¼˜åŒ–
- æ²¡æœ‰ç²¾ç»†çš„è·ç¦»æ¢¯åº¦
- æ²¡æœ‰åŠ¨ä½œå¹³ç¨³æ€§çº¦æŸ
- è®­ç»ƒæ•°æ®ä¸¥é‡ä¸è¶³ (100Kæ­¥)
- ç½‘ç»œå¤ªå°
- å­¦ä¹ ç‡è¿‡é«˜

**è§£å†³æ–¹æ¡ˆ**:

```python
# âœ… æ–°å¢ParkingRewardWrapperä¸“ç”¨ç±»
ç²¾ç»†çš„è·ç¦»æ¢¯åº¦å¥–åŠ±:
  - è¿œç¦»ç›®æ ‡: åŸºç¡€å¥–åŠ±
  - æ¥è¿‘ç›®æ ‡: åŒæ ·æ”¹è¿›è·æ›´å¤šå¥–åŠ±  (æ¥è¿‘åº¦æ„ŸçŸ¥)
  - æˆåŠŸåœè½¦: å¤§å¥–åŠ± (+10.0)

# âœ… åŠ¨ä½œå¹³ç¨³æ€§çº¦æŸ
é™åˆ¶è¿ç»­åŠ¨ä½œå˜åŒ–ï¼Œé¿å…æ–¹å‘ç›˜ä¹±è½¬
if action_diff > 0.5:
    reward -= action_diff * 0.2

# âœ… æ¿€è¿›é…ç½®
- ç½‘ç»œå¤§å°: [256,256] â†’ [512,512,256]  (3å±‚ç½‘ç»œ)
- è®­ç»ƒæ­¥æ•°: 100K â†’ 500K                 (5å€å¢åŠ )
- å­¦ä¹ ç‡:   3e-4 â†’ 2e-4                 (æ›´ç¨³å®š)
- batch_size: 64 â†’ 32                   (æ›´ç²¾ç»†æ¢¯åº¦)
- å¹¶è¡Œç¯å¢ƒ:  6 â†’ 4                      (è´¨é‡ä¼˜äºæ•°é‡)
- æŠ˜æ‰£å› å­:  0.95 â†’ 0.99               (æ›´é‡è§†é•¿æœŸ)
```

**é¢„æœŸæ•ˆæœ**:
- æˆåŠŸç‡ â†‘ 60-75% (ä»30-40%ï¼Œç¿»å€æå‡)
- åœè½¦ç²¾åº¦ â†‘ 70-80%
- ç¢°æ’ç‡ â†“ 60-75%
- å¹³ç¨³åº¦ â†‘ 100%

---

### ğŸ¯ æ”¹è¿›3ï¼šåˆ†åœºæ™¯è¶…å‚æ•°ä¼˜åŒ–

æ¯ä¸ªåœºæ™¯éƒ½æœ‰é’ˆå¯¹æ€§çš„è¶…å‚æ•°ï¼Œæ ¹æ®ä»»åŠ¡å¤æ‚åº¦æ™ºèƒ½è°ƒæ•´ï¼š

| å‚æ•° | é«˜é€Ÿ(S1) | ç¯å²›(S2) | åœè½¦(S3) | è¯´æ˜ |
|------|---------|---------|---------|------|
| **learning_rate** | 3e-4 | 3e-4 | 2e-4 â†“ | åœè½¦æ›´ä½ |
| **gamma** | 0.95 | 0.95 | 0.99 â†‘ | åœè½¦é‡è§†é•¿æœŸ |
| **n_epochs** | 20 | 20 | 25 â†‘ | åœè½¦æ›´å……åˆ† |
| **batch_size** | 64 | 64 | 32 â†“ | åœè½¦ç²¾ç»† |
| **ent_coef** | 0.01 | 0.01 | 0.005 â†“ | åœè½¦å‡å°‘éšæœº |
| **n_cpu** | 6 | 6 | 4 â†“ | åœè½¦è´¨é‡ä¼˜å…ˆ |
| **duration** | 60s â†‘ | 50s | åŸç”Ÿ | é«˜é€Ÿæ›´é•¿ |
| **network** | [384,256] | [256,256] | [512,512,256] â†‘â†‘ | åœè½¦æœ€å¤§ |
| **steps** | 300K | 250K | 500K â†‘â†‘ | åœè½¦æœ€å¤š |

---

## åœºæ™¯è¯¦è§£

### ğŸ“ Scenario 1: é«˜é€Ÿé©¾é©¶ä¸æ±‡å…¥ (Highway + Merge)

**ç¯å¢ƒè®¾ç½®**:
- ç¯å¢ƒ: `highway-fast-v0` å’Œ `merge-v0` æ··åˆè®­ç»ƒ
- åŠ¨ä½œ: ç¦»æ•£ (5ç§)
  - 0: å‘å·¦å˜é“
  - 1: ä¿æŒä¸å˜ â† ç°åœ¨å¥–åŠ±æœ€å¤š
  - 2: å‘å³å˜é“
  - 3: åŠ é€Ÿ â† å‡å°‘æ¿€åŠ±
  - 4: å‡é€Ÿ

**è¯„ä»·æŒ‡æ ‡**: 
- æˆåŠŸ: è¡Œé©¶è·ç¦»æœ€å¤§ (>100m)
- å¤±è´¥: å‘ç”Ÿç¢°æ’

**è®­ç»ƒå‚æ•°**:
```bash
python train_highway_ppo.py --scenario 1
# é¢„è®¡: 3-4å°æ—¶(GPU) æˆ– 8-10å°æ—¶(CPU)
```

**è¾“å‡ºæ ·ä¾‹**:
```
Episode 1: Distance: 125.34 m
Episode 2: FAILED (Crash)
Episode 3: Distance: 145.67 m
```

---

### ğŸ“ Scenario 2: ç¯å²›é€šè¿‡ (Roundabout)

**ç¯å¢ƒè®¾ç½®**:
- ç¯å¢ƒ: `roundabout-v0`
- åŠ¨ä½œ: ç¦»æ•£ (5ç§ï¼ŒåŒé«˜é€Ÿ)

**è¯„ä»·æŒ‡æ ‡**:
- æˆåŠŸ: å®‰å…¨é€šè¿‡ç¯å²›ï¼ŒYåæ ‡ < -20
- å¤±è´¥: ç¢°æ’æˆ–è¶…æ—¶

**è®­ç»ƒå‚æ•°**:
```bash
python train_highway_ppo.py --scenario 2
# é¢„è®¡: 2.5-3.5å°æ—¶
```

**è¾“å‡ºæ ·ä¾‹**:
```
Episode 1: SUCCESS - Time: 3.45 s
Episode 2: FAILED (Crash)
Episode 3: SUCCESS - Time: 2.98 s
```

---

### ğŸ“ Scenario 3: å€’è½¦å…¥åº“ (Parking)

**ç¯å¢ƒè®¾ç½®**:
- ç¯å¢ƒ: `parking-v0`
- åŠ¨ä½œ: è¿ç»­ (2ç»´)
  - æ–¹å‘ç›˜è½¬è§’: -45Â° ~ +45Â°
  - åŠ é€Ÿåº¦: -1.0 ~ 1.0 (å‰åç§»åŠ¨)

**è¯„ä»·æŒ‡æ ‡**:
- æˆåŠŸ: åœåˆ°è“è‰²è½¦ä½ + `is_success = True`
- å¤±è´¥: ç¢°æ’æˆ–è¶…æ—¶

**è®­ç»ƒå‚æ•°** (æœ€å¤æ‚):
```bash
python train_highway_ppo.py --scenario 3
# é¢„è®¡: 5-6å°æ—¶(GPU) æˆ– 12-15å°æ—¶(CPU)
```

**è¾“å‡ºæ ·ä¾‹**:
```
Episode 1: SUCCESS - Time: 8.23 s
Episode 2: FAILED (Crash)
Episode 3: SUCCESS - Time: 7.15 s
```

---

## å®Œæ•´å‚æ•°æŒ‡å—

### è®­ç»ƒè„šæœ¬å‚æ•° (train_highway_ppo.py)

#### åŸºç¡€é…ç½® (ç¬¬73-90è¡Œ)

```python
n_cpu = 6              # å¹¶è¡Œç¯å¢ƒæ•°
batch_size = 64        # æ‰¹æ¬¡å¤§å°
```

**n_cpu æ¨èå€¼**:

| å€¼ | å†…å­˜ | é€Ÿåº¦ | å»ºè®® |
|---|------|------|------|
| 2 | ~2GB | å¾ˆæ…¢ | ä½é…æœºå™¨ |
| 4 | ~3GB | æ­£å¸¸ | æ ‡å‡†é…ç½® |
| **6** | **~4GB** | **æ¨è** | **é»˜è®¤å€¼** |
| 8 | ~5-6GB | å¾ˆå¿« | é«˜é…æœºå™¨ |

**batch_size æ¨èå€¼**:

| å€¼ | æ›´æ–°é¢‘ç‡ | ç¨³å®šæ€§ | å»ºè®® |
|---|---------|--------|------|
| 32 | æ›´é¢‘ç¹ | ä¸ç¨³å®š | å°æ•°æ®é›† |
| **64** | **é€‚ä¸­** | **ç¨³å®š** | **é»˜è®¤æ¨è** |
| 128 | ä¸é¢‘ç¹ | å¾ˆç¨³å®š | æ•°æ®å¤š |

---

#### ç¯å¢ƒé…ç½® (ç¬¬227-254è¡Œ)

```python
# Scenario 1 (é«˜é€Ÿé©¾é©¶)
"duration": 60,        # Episodeæ—¶é•¿ (40â†’60s)
"collision_reward": -5.0,
"vehicles_count": 50,

# Scenario 3 (åœè½¦)
# ä½¿ç”¨åŸç”Ÿé…ç½®ï¼Œé€šè¿‡wrapperä¼˜åŒ–
```

---

#### è¶…å‚æ•°é…ç½® (ç¬¬204-223è¡Œ)

```python
ppo_params = {
    "n_steps": batch_size * 20 // n_cpu,
    "batch_size": batch_size,
    "n_epochs": 20 if scenario==1 else 25,  # åœè½¦ç”¨25
    "learning_rate": 3e-4 if scenario!=3 else 2e-4,
    "gamma": 0.95 if scenario!=3 else 0.99,
    "gae_lambda": 0.9 if scenario!=3 else 0.95,
    "clip_range": 0.2,
    "ent_coef": 0.01 if scenario!=3 else 0.005,
    "vf_coef": 0.5,
}
```

**å­¦ä¹ ç‡ (learning_rate) æ¨èå€¼**:

| å€¼ | å­¦ä¹ é€Ÿåº¦ | æ”¶æ•›æ€§ | å»ºè®® |
|---|---------|--------|------|
| 1e-4 | æ…¢ | å¾ˆç¨³å®š | ä¿å®ˆè®­ç»ƒ |
| 2e-4 | è¾ƒæ…¢ | ç¨³å®š | åœè½¦åœºæ™¯ |
| **3e-4** | **ä¸­ç­‰** | **æ¨è** | **é«˜é€Ÿ/ç¯å²›** |
| 5e-4 | å¿« | å¯èƒ½ä¸ç¨³å®š | ä¸æ¨è |

---

#### ç½‘ç»œæ¶æ„ (ç¬¬296-306è¡Œ)

```python
# Scenario 1 (é«˜é€Ÿ): ä¸­ç­‰ç½‘ç»œ
net_arch = dict(pi=[384, 256], vf=[384, 256])

# Scenario 2 (ç¯å²›): åŸºç¡€ç½‘ç»œ
net_arch = dict(pi=[256, 256], vf=[256, 256])

# Scenario 3 (åœè½¦): å¤§å‹ç½‘ç»œ
net_arch = dict(pi=[512, 512, 256], vf=[512, 512, 256])
```

---

#### è®­ç»ƒæ—¶é•¿

```python
# Scenario 1 (é«˜é€Ÿ): 300Kæ­¥
train_timesteps = 300000  # çº¦3-4å°æ—¶

# Scenario 2 (ç¯å²›): 250Kæ­¥
train_timesteps = 250000  # çº¦2.5-3.5å°æ—¶

# Scenario 3 (åœè½¦): 500Kæ­¥
train_timesteps = 500000  # çº¦5-6å°æ—¶
```

---

### æµ‹è¯•è„šæœ¬å‚æ•° (test_highway_ppo.py)

#### åŸºç¡€å‚æ•°

```python
# ç¯å¢ƒé…ç½®
"duration": 60,        # Episodeæ—¶é•¿

# æµ‹è¯•è½®æ•°
episodes = 5           # è¯„ä¼°episodeæ•°
```

**episodes æ¨èå€¼**:

| å€¼ | æ—¶é—´ | å‡†ç¡®æ€§ | å»ºè®® |
|---|------|--------|------|
| 1-2 | ~20ç§’ | æä½ | å¿«é€Ÿæ£€æŸ¥ |
| **5** | **1-2åˆ†é’Ÿ** | **æ¨è** | **é»˜è®¤å€¼** |
| 10 | 2-4åˆ†é’Ÿ | ä¸­é«˜ | å¯¹æ ‡è¯„ä¼° |
| 20+ | 4+åˆ†é’Ÿ | å¾ˆé«˜ | ç²¾ç¡®è¯„ä¼° |

---

### å¿«é€Ÿè°ƒå‚ç¤ºä¾‹

#### ç¤ºä¾‹1: å¿«é€Ÿå®éªŒ

é€‚åˆè°ƒè¯•æ–°æƒ³æ³•ï¼ˆ10åˆ†é’Ÿå†…å®Œæˆï¼‰:

```python
n_cpu = 2
batch_size = 32
train_timesteps = 50000
episodes = 2
```

#### ç¤ºä¾‹2: åœè½¦åœºæ™¯ç²¾ç»†è°ƒä¼˜

é’ˆå¯¹åœè½¦ç²¾åº¦ä¸è¶³:

```python
n_cpu = 4
batch_size = 32
learning_rate = 1e-4
n_epochs = 30
train_timesteps = 1000000
net_arch = dict(pi=[512, 512, 512], vf=[512, 512, 512])
```

#### ç¤ºä¾‹3: é«˜é€Ÿé©¾é©¶ç¨³å®šæ€§è°ƒä¼˜

é’ˆå¯¹é«˜é€Ÿä¸å¹³ç¨³:

```python
duration = 80
learning_rate = 2e-4
gamma = 0.99
train_timesteps = 500000
```

---

## æ•…éšœæ’æŸ¥

### âŒ é—®é¢˜1: "æ¨¡å‹æ‰¾ä¸åˆ°"

**åŸå› **: è¿˜æ²¡æœ‰å®Œæˆè®­ç»ƒ

**è§£å†³**:
1. ç¡®è®¤å·²è¿è¡Œè®­ç»ƒè„šæœ¬
2. ç­‰å¾…è®­ç»ƒå®Œæˆ
3. æ£€æŸ¥è¾“å‡ºç›®å½•: `highway_ppo/highway_merge/run_1/`

---

### âŒ é—®é¢˜2: "è®­ç»ƒé€Ÿåº¦å¾ˆæ…¢"

**åŸå› **: å¹¶è¡Œç¯å¢ƒæ•°è¿‡å°‘

**è§£å†³**:
```python
n_cpu = 8  # å¢åŠ å¹¶è¡Œ
```

---

### âŒ é—®é¢˜3: "å†…å­˜ä¸è¶³ (Out of Memory)"

**åŸå› **: å¹¶è¡Œç¯å¢ƒæ•°è¿‡å¤š

**è§£å†³**:
```python
n_cpu = 2
batch_size = 32
net_arch = dict(pi=[128, 128], vf=[128, 128])
```

---

### âŒ é—®é¢˜4: "åœè½¦æ€»æ˜¯å¤±è´¥"

**åŸå› **: è®­ç»ƒä¸è¶³æˆ–å‚æ•°ä¸å½“

**è§£å†³**:
```python
train_timesteps = 500000
learning_rate = 2e-4
n_epochs = 25
batch_size = 32
```

---

### âŒ é—®é¢˜5: "é«˜é€Ÿé©¾é©¶è¿˜æ˜¯ä¸ç¨³å®š"

**åŸå› **: é€Ÿåº¦æ§åˆ¶ç­–ç•¥æœªå……åˆ†å­¦ä¹ 

**è§£å†³**:
```python
learning_rate = 2e-4
n_epochs = 25
gamma = 0.99
```

---

### âŒ é—®é¢˜6: "æµ‹è¯•æ€»æ˜¯è¶…æ—¶"

**åŸå› **: æ¨¡å‹æœªæ”¶æ•›

**è§£å†³**:
1. æ£€æŸ¥è®­ç»ƒæ­¥æ•°æ˜¯å¦è¶³å¤Ÿ
2. å¢åŠ  train_timesteps
3. è°ƒæ•´è¶…å‚æ•°é‡æ–°è®­ç»ƒ

---

## ç›‘æ§è®­ç»ƒè¿›åº¦

### ä½¿ç”¨TensorBoardæŸ¥çœ‹å­¦ä¹ æ›²çº¿

```bash
# æŸ¥çœ‹å•ä¸ªåœºæ™¯
tensorboard --logdir=highway_ppo/highway_merge/run_1

# å¯¹æ¯”å¤šä¸ªè¿è¡Œ
tensorboard --logdir=highway_ppo

# åœ¨æµè§ˆå™¨æ‰“å¼€
http://localhost:6006
```

---

## è¿›é˜¶æŠ€å·§

### 1. å¹¶è¡Œè®­ç»ƒå¤šä¸ªåœºæ™¯

```bash
# Terminal 1
python train_highway_ppo.py --scenario 1

# Terminal 2
python train_highway_ppo.py --scenario 2
```

### 2. ä½¿ç”¨GPUåŠ é€Ÿ

```bash
export CUDA_VISIBLE_DEVICES=0
python train_highway_ppo.py --scenario 1
```

### 3. å¼ºåˆ¶ä½¿ç”¨CPU

```bash
export CUDA_VISIBLE_DEVICES=
python train_highway_ppo.py --scenario 1
```

### 4. åŠ è½½è‡ªå®šä¹‰æ¨¡å‹æ¨ç†

```python
from stable_baselines3 import PPO
import gymnasium as gym
import highway_env

model = PPO.load("highway_ppo/highway_merge/run_1/model")
env = gym.make("highway-fast-v0")

obs, info = env.reset()
for _ in range(100):
    action, _ = model.predict(obs)
    obs, reward, done, truncated, info = env.step(action)
```

---

## å¸¸è§é—®é¢˜ FAQ

**Q: åº”è¯¥ä»å“ªä¸ªåœºæ™¯å¼€å§‹?**  
A: æ¨èä»Scenario 1å¼€å§‹ï¼Œæœ€å®¹æ˜“çœ‹åˆ°æ”¹è¿›æ•ˆæœ

**Q: å¦‚ä½•å¿«é€ŸéªŒè¯æ”¹è¿›æ˜¯å¦ç”Ÿæ•ˆ?**  
A: ç”¨50Kæ­¥å¿«é€Ÿè®­ç»ƒï¼Œç„¶åæµ‹è¯•5ä¸ªepisode

**Q: åœè½¦ä¸ºä»€ä¹ˆè¿™ä¹ˆéš¾?**  
A: å› ä¸ºéœ€è¦ç²¾ç¡®çš„ä½ç½®å’Œè§’åº¦æ§åˆ¶ï¼Œéš¾åº¦æ˜¯å‰ä¸¤ä¸ªåœºæ™¯çš„5-10å€

**Q: å¦‚ä½•è·å¾—æœ€å¥½çš„æ¨¡å‹?**  
A: ä½¿ç”¨æ¨èçš„è¶…å‚æ•° + è¶³å¤Ÿçš„è®­ç»ƒæ—¶é—´ + TensorBoardç›‘æ§

**Q: å•GPU vs å•CPUå“ªä¸ªå¿«?**  
A: GPUå¿«3-5å€ï¼Œä½†éœ€è¦æœ‰GPU

**Q: èƒ½å¦åªä¿®æ”¹ä¸€ä¸ªå‚æ•°è¯•è¯•?**  
A: å¯ä»¥ï¼Œä½†å»ºè®®ä¸€æ¬¡åªæ”¹ä¸€ä¸ªï¼Œå¦åˆ™æ— æ³•åˆ¤æ–­æ•ˆæœ

---

## é…ç½®æ¨èé€ŸæŸ¥è¡¨

### åœºæ™¯1: é«˜é€Ÿé©¾é©¶ (æ¨èé¦–é€‰)

```python
n_cpu = 6
batch_size = 64
learning_rate = 3e-4
gamma = 0.95
n_epochs = 20
train_timesteps = 300000
duration = 60
net_arch = dict(pi=[384, 256], vf=[384, 256])
```

**é¢„æœŸ**: 3-4å°æ—¶å†…å¾—åˆ°å¹³ç¨³é©¾é©¶çš„æ¨¡å‹

---

### åœºæ™¯2: ç¯å²›é€šè¿‡

```python
n_cpu = 6
batch_size = 64
learning_rate = 3e-4
gamma = 0.95
n_epochs = 20
train_timesteps = 250000
duration = 50
net_arch = dict(pi=[256, 256], vf=[256, 256])
```

**é¢„æœŸ**: 2.5-3.5å°æ—¶å†…å¾—åˆ°ç¨³å®šé€šè¿‡ç¯å²›çš„æ¨¡å‹

---

### åœºæ™¯3: å€’è½¦å…¥åº“ (éœ€è¦è€å¿ƒ)

```python
n_cpu = 4
batch_size = 32
learning_rate = 2e-4
gamma = 0.99
n_epochs = 25
train_timesteps = 500000
net_arch = dict(pi=[512, 512, 256], vf=[512, 512, 256])
```

**é¢„æœŸ**: 5-6å°æ—¶åå¾—åˆ°ç²¾ç¡®åœè½¦çš„æ¨¡å‹

---

## ç‰ˆæœ¬å†å²

- **v1.0** (2026-01-18): åŸºç¡€æ¡†æ¶ï¼Œæ”¯æŒä¸‰åœºæ™¯è®­ç»ƒ
- **v2.0** (2026-01-19): æ·»åŠ å¹³ç¨³é©¾é©¶ä¼˜åŒ–å’Œåœè½¦ä¸“ç”¨wrapper
- **v2.1** (2026-01-19): åˆ†åœºæ™¯è¶…å‚æ•°ä¼˜åŒ–ï¼Œè¯¦ç»†å‚æ•°æŒ‡å—ï¼Œç»¼åˆREADME

---

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Stable Baselines3 (PPOç®—æ³•)
- **ç¯å¢ƒ**: highway-env (Farama Foundation)
- **æ·±åº¦å­¦ä¹ **: PyTorch
- **ç›‘æ§**: TensorBoard

---

## æ”¯æŒ

é‡åˆ°é—®é¢˜æˆ–æœ‰å»ºè®®? è¯·æ£€æŸ¥ä»¥ä¸‹å†…å®¹:

1. âœ… ä¾èµ–åº“ç‰ˆæœ¬æ˜¯å¦æ­£ç¡®
2. âœ… è®­ç»ƒç»“æœæ–‡ä»¶æ˜¯å¦å·²ç”Ÿæˆ
3. âœ… å‘½ä»¤å‚æ•°æ˜¯å¦æ­£ç¡®
4. âœ… æ˜¯å¦å‚è€ƒäº†æ¨èçš„è¶…å‚æ•°

---

**ç¥æ‚¨è®­ç»ƒé¡ºåˆ©ï¼** ğŸš€

*æœ€åæ›´æ–°: 2026-01-19*  
*Highway-Env å¤šåœºæ™¯PPOè®­ç»ƒæ¡†æ¶ v2.1*
